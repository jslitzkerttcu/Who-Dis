<div class="bg-white rounded-lg shadow p-4 space-y-4">
    <!-- Cache Actions -->
    <h3 class="text-base font-medium text-gray-600 mb-4">Cache Management Actions</h3>
    <div class="space-y-3">
        <!-- Search Cache -->
        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0 flex-1">
                    <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-search text-blue-600 text-lg"></i>
                    </div>
                    <div class="ml-4 min-w-0 flex-1">
                        <h5 class="font-semibold text-gray-900 text-sm">Search Cache</h5>
                        <p class="text-xs text-gray-500 mt-0.5">User search results cache</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 ml-4">
                    <button class="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            hx-post="{{ url_for('admin.api_cache_refresh', cache_type='search') }}"
                            hx-target="#search-cache-result"
                            hx-swap="innerHTML"
                            hx-indicator="#search-refresh-spinner">
                        <i class="fas fa-sync-alt mr-1.5"></i>
                        Refresh
                        <span id="search-refresh-spinner" class="htmx-indicator ml-1.5">
                            <i class="fas fa-spinner fa-spin"></i>
                        </span>
                    </button>
                    <button class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            onclick="showClearModal('search', 'Search Cache', '{{ url_for('admin.clear_single_cache', cache_type='search') }}')">
                        <i class="fas fa-trash mr-1.5"></i>
                        Clear
                    </button>
                </div>
            </div>
            <div id="search-cache-result" class="mt-3"></div>
        </div>
        
        <!-- Genesys Cache -->
        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0 flex-1">
                    <div class="flex-shrink-0 w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-headset text-orange-600 text-lg"></i>
                    </div>
                    <div class="ml-4 min-w-0 flex-1">
                        <h5 class="font-semibold text-gray-900 text-sm">Genesys Cache</h5>
                        <p class="text-xs text-gray-500 mt-0.5">Groups, skills, and locations</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 ml-4">
                    <button class="px-3 py-2 bg-orange-500 hover:bg-orange-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            hx-post="{{ url_for('admin.api_cache_refresh', cache_type='genesys') }}"
                            hx-target="#genesys-cache-result"
                            hx-swap="innerHTML"
                            hx-indicator="#genesys-cache-refresh-spinner">
                        <i class="fas fa-sync-alt mr-1.5"></i>
                        Refresh
                        <span id="genesys-cache-refresh-spinner" class="htmx-indicator ml-1.5">
                            <i class="fas fa-spinner fa-spin"></i>
                        </span>
                    </button>
                    <button class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            onclick="showClearModal('genesys', 'Genesys Cache', '{{ url_for('admin.clear_single_cache', cache_type='genesys') }}')">
                        <i class="fas fa-trash mr-1.5"></i>
                        Clear
                    </button>
                </div>
            </div>
            <div id="genesys-cache-result" class="mt-3"></div>
        </div>
        
        <!-- Data Warehouse Cache -->
        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0 flex-1">
                    <div class="flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-warehouse text-purple-600 text-lg"></i>
                    </div>
                    <div class="ml-4 min-w-0 flex-1">
                        <h5 class="font-semibold text-gray-900 text-sm">Data Warehouse Cache</h5>
                        <p class="text-xs text-gray-500 mt-0.5">User data from SQL Server</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 ml-4">
                    <button class="px-3 py-2 bg-purple-500 hover:bg-purple-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            hx-post="{{ url_for('admin.refresh_data_warehouse_cache') }}"
                            hx-target="#dw-cache-result"
                            hx-swap="innerHTML"
                            hx-indicator="#dw-cache-refresh-spinner">
                        <i class="fas fa-sync-alt mr-1.5"></i>
                        Refresh
                        <span id="dw-cache-refresh-spinner" class="htmx-indicator ml-1.5">
                            <i class="fas fa-spinner fa-spin"></i>
                        </span>
                    </button>
                    <button class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            onclick="showClearModal('data-warehouse', 'Data Warehouse Cache', '{{ url_for('admin.clear_data_warehouse_cache') }}')">
                        <i class="fas fa-trash mr-1.5"></i>
                        Clear
                    </button>
                </div>
            </div>
            <div id="dw-cache-result" class="mt-3"></div>
        </div>
        
        <!-- Graph Photo Cache -->
        <div class="border rounded-lg p-4 hover:shadow-md transition-shadow duration-200">
            <div class="flex items-center justify-between">
                <div class="flex items-center min-w-0 flex-1">
                    <div class="flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-camera text-blue-600 text-lg"></i>
                    </div>
                    <div class="ml-4 min-w-0 flex-1">
                        <h5 class="font-semibold text-gray-900 text-sm">Graph Photo Cache</h5>
                        <p class="text-xs text-gray-500 mt-0.5">Microsoft Graph user photos</p>
                    </div>
                </div>
                <div class="flex items-center space-x-2 ml-4">
                    <button class="px-3 py-2 bg-gray-400 cursor-not-allowed text-white text-xs font-medium rounded-md flex items-center whitespace-nowrap opacity-50" disabled>
                        <i class="fas fa-sync-alt mr-1.5"></i>
                        Refresh
                    </button>
                    <button class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-medium rounded-md transition duration-150 flex items-center whitespace-nowrap"
                            onclick="showClearModal('photos', 'Graph Photo Cache', '{{ url_for('admin.clear_single_cache', cache_type='photos') }}')">
                        <i class="fas fa-trash mr-1.5"></i>
                        Clear
                    </button>
                </div>
            </div>
            <div id="photo-cache-result" class="mt-3"></div>
        </div>
    </div>
    
    <!-- Cache Settings -->
    <div class="border-t pt-4 mt-2">
        <h3 class="text-base font-medium text-gray-600 mb-4 flex items-center">
            <i class="fas fa-cog mr-2 text-gray-500"></i>
            Cache Settings
        </h3>
        <div class="space-y-2 text-sm">
            <div class="flex items-center justify-between">
                <span class="text-gray-600">Search Cache TTL:</span>
                <span class="font-medium">24 hours</span>
            </div>
            <div class="flex items-center justify-between">
                <span class="text-gray-600">API Cache TTL:</span>
                <span class="font-medium">6 hours</span>
            </div>
            <div class="flex items-center justify-between">
                <span class="text-gray-600">Auto-refresh:</span>
                <span class="font-medium text-green-600">Enabled</span>
            </div>
        </div>
    </div>
</div>

<!-- Confirmation Modal -->
<div id="clearModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
                <i class="fas fa-exclamation-triangle text-red-600"></i>
            </div>
            <h3 class="text-lg leading-6 font-medium text-gray-900 mt-4" id="modalTitle">Clear Cache</h3>
            <div class="mt-2 px-7 py-3">
                <p class="text-sm text-gray-500" id="modalMessage">
                    Are you sure you want to clear all entries from this cache? This action cannot be undone.
                </p>
            </div>
            <div class="flex justify-center space-x-4 mt-4">
                <button type="button" 
                        class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 text-sm font-medium rounded-md transition duration-150"
                        onclick="closeModal()">
                    Cancel
                </button>
                <button type="button" 
                        id="confirmClearBtn"
                        class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white text-sm font-medium rounded-md transition duration-150 flex items-center">
                    <i class="fas fa-trash mr-2"></i>
                    Clear Cache
                    <span id="modal-clear-spinner" class="htmx-indicator ml-2">
                        <i class="fas fa-spinner fa-spin"></i>
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function showClearModal(cacheType, cacheName, clearUrl) {
    // Update modal content
    document.getElementById('modalTitle').textContent = `Clear ${cacheName}`;
    
    // Set the confirm button action
    const confirmBtn = document.getElementById('confirmClearBtn');
    confirmBtn.setAttribute('hx-post', clearUrl);
    confirmBtn.setAttribute('hx-target', `#${cacheType}-cache-result`);
    confirmBtn.setAttribute('hx-swap', 'innerHTML');
    confirmBtn.setAttribute('hx-indicator', '#modal-clear-spinner');
    
    // Process the button with htmx
    htmx.process(confirmBtn);
    
    // Show modal
    document.getElementById('clearModal').classList.remove('hidden');
}

function closeModal() {
    document.getElementById('clearModal').classList.add('hidden');
}

// Close modal when clicking outside
document.getElementById('clearModal').addEventListener('click', function(event) {
    if (event.target === this) {
        closeModal();
    }
});

// Close modal after successful clear
document.body.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.detail.target.id && evt.detail.target.id.includes('-cache-result')) {
        closeModal();
    }
});
</script>